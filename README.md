# 年間行事予定カレンダー連携ツール

このツールは、スプレッドシートで管理している年間行事予定をGoogleカレンダーに自動的に書き込むためのGoogle Apps Scriptプロジェクトです。スプレッドシートを原本として、カレンダーを常に最新の状態に保つことができます。

## 主な機能

- スプレッドシートの年間行事予定をGoogleカレンダーに書き込み
- 書き込み時に指定期間内の既存の予定をすべて削除し、スプレッドシートの内容で更新
- 祝日データの行事予定への追加・削除
- 特定の曜日に毎週同じ予定を一括追加・削除
- 時間指定のある予定と終日予定の両方に対応

## 使用方法

### 対象スプレッドシート

年間行事予定表2025: [https://docs.google.com/spreadsheets/d/1uW0iHBca0djbXUHahJRmQaRJ6H-JwkONOOFVWXf2fo0/copy](https://docs.google.com/spreadsheets/d/1uW0iHBca0djbXUHahJRmQaRJ6H-JwkONOOFVWXf2fo0/copy)

### 初期設定

1. スプレッドシートのA1セルに西暦を入力します
2. E1セルに書き込み先のGoogleカレンダーIDを入力します
   - カレンダーIDはGoogleカレンダーの設定から取得できます

### メニュー操作

スプレッドシートを開くと、メニューバーに「年間行事予定」というメニューが表示されます。このメニューから以下の操作が可能です：

- **カレンダーへ書き込み実行**: スプレッドシートの予定をカレンダーに書き込みます
- **祝日を行事予定に追加**: AA列の祝日データを行事予定に追加します
- **祝日を行事予定から削除**: 行事予定から祝日を削除します
- **毎週の予定を追加**: 特定の曜日に毎週同じ予定を追加します
- **毎週の予定を削除**: 特定の予定を行事予定から削除します

## スプレッドシートの構成

スプレッドシートは以下の構成になっています：

- **A1セル**: 西暦
- **E1セル**: カレンダーID
- **3行目以降**: 年間行事予定データ
  - 奇数列（A, C, E...）: 日付
  - 偶数列（B, D, F...）: 行事予定
- **AA列以降**: 祝日データ

## 予定の書き方

### 基本形式

行事予定は、カンマ（,）で区切ることで複数の予定を同じ日に登録できます。

例: `運動会,PTA総会`

### 時間指定

時間を指定する場合は、予定名の後に `<開始時刻-終了時刻>` の形式で記述します。

例: `授業参観<13:00-15:00>`

## 注意事項

- カレンダーへの書き込み実行時、指定期間内の既存の予定はすべて削除されます
- 大量の予定を一度に書き込む場合、Google APIの制限により処理に時間がかかることがあります
- 時間指定の形式は必ず `<開始時刻-終了時刻>` の形式で記述してください

## バージョン履歴

- ver1 (2020/02/23): 初版作成
- ver2 (2021/03/31): 1年分書込み対応
- ver3 (2021/04/01): カンマ区切りで複数日程対応
- ver4 (2021/08/18): 時間指定機能追加（<12:00-14:00>形式）
- ver5 (2021/09/05): 全角ハイフン「ー」対応
- ver5.1 (2022/02/02): 全角ハイフン「−」対応
- ver6 (2025/03/22): カレンダー同期機能強化（既存予定の削除と再同期）

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルをご覧ください。

Copyright (c) 2025 Noboru Ando @ Aoyama Gakuin University
